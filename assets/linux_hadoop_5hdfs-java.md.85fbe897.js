import{_ as s,c as n,o as a,a as l}from"./app.f6b8b16b.js";const C=JSON.parse('{"title":"HDFS Java\u5F00\u53D1","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u521D\u59CB\u5316\u73AF\u5883","slug":"\u521D\u59CB\u5316\u73AF\u5883","link":"#\u521D\u59CB\u5316\u73AF\u5883","children":[{"level":3,"title":"\u628A hadoop-3.1.4.tar.gz \u89E3\u538B\u5230\u672C\u5730\u4E00\u4E2A\u975E\u82F1\u6587\u76EE\u5F55\u4E0B","slug":"\u628A-hadoop-3-1-4-tar-gz-\u89E3\u538B\u5230\u672C\u5730\u4E00\u4E2A\u975E\u82F1\u6587\u76EE\u5F55\u4E0B","link":"#\u628A-hadoop-3-1-4-tar-gz-\u89E3\u538B\u5230\u672C\u5730\u4E00\u4E2A\u975E\u82F1\u6587\u76EE\u5F55\u4E0B","children":[]},{"level":3,"title":"\u5BFC\u5165 winutils \u5DE5\u5177\u5305\uFF1A","slug":"\u5BFC\u5165-winutils-\u5DE5\u5177\u5305\uFF1A","link":"#\u5BFC\u5165-winutils-\u5DE5\u5177\u5305\uFF1A","children":[]},{"level":3,"title":"\u914D\u7F6E\u73AF\u5883\u53D8\u91CF HADOOP_HOME\u3001HADOOP_USER_NAME","slug":"\u914D\u7F6E\u73AF\u5883\u53D8\u91CF-hadoop-home\u3001hadoop-user-name","link":"#\u914D\u7F6E\u73AF\u5883\u53D8\u91CF-hadoop-home\u3001hadoop-user-name","children":[]}]},{"level":2,"title":"\u914D\u7F6E IDEA","slug":"\u914D\u7F6E-idea","link":"#\u914D\u7F6E-idea","children":[{"level":3,"title":"IDEA \u5B89\u88C5 Big Data Tools \u63D2\u4EF6","slug":"idea-\u5B89\u88C5-big-data-tools-\u63D2\u4EF6","link":"#idea-\u5B89\u88C5-big-data-tools-\u63D2\u4EF6","children":[]},{"level":3,"title":"\u914D\u7F6E Big Data Tools","slug":"\u914D\u7F6E-big-data-tools","link":"#\u914D\u7F6E-big-data-tools","children":[]},{"level":3,"title":"\u67E5\u770B HDFS \u662F\u5426\u8FDE\u63A5\u6210\u529F","slug":"\u67E5\u770B-hdfs-\u662F\u5426\u8FDE\u63A5\u6210\u529F","link":"#\u67E5\u770B-hdfs-\u662F\u5426\u8FDE\u63A5\u6210\u529F","children":[]}]},{"level":2,"title":"\u521B\u5EFA Maven \u9879\u76EE","slug":"\u521B\u5EFA-maven-\u9879\u76EE","link":"#\u521B\u5EFA-maven-\u9879\u76EE","children":[{"level":3,"title":"1. \u65B0\u5EFA Maven \u9879\u76EE","slug":"_1-\u65B0\u5EFA-maven-\u9879\u76EE","link":"#_1-\u65B0\u5EFA-maven-\u9879\u76EE","children":[]},{"level":3,"title":"2. \u5BFC\u5165hadoop\u7684\u4F9D\u8D56","slug":"_2-\u5BFC\u5165hadoop\u7684\u4F9D\u8D56","link":"#_2-\u5BFC\u5165hadoop\u7684\u4F9D\u8D56","children":[]}]},{"level":2,"title":"HDFS \u64CD\u4F5C","slug":"hdfs-\u64CD\u4F5C","link":"#hdfs-\u64CD\u4F5C","children":[{"level":3,"title":"1. \u4F7F\u7528 HDFS \u521B\u5EFA\u76EE\u5F55","slug":"_1-\u4F7F\u7528-hdfs-\u521B\u5EFA\u76EE\u5F55","link":"#_1-\u4F7F\u7528-hdfs-\u521B\u5EFA\u76EE\u5F55","children":[]},{"level":3,"title":"2. \u4E0A\u4F20\u6587\u4EF6","slug":"_2-\u4E0A\u4F20\u6587\u4EF6","link":"#_2-\u4E0A\u4F20\u6587\u4EF6","children":[]},{"level":3,"title":"3. \u4E0B\u8F7D\u6587\u4EF6","slug":"_3-\u4E0B\u8F7D\u6587\u4EF6","link":"#_3-\u4E0B\u8F7D\u6587\u4EF6","children":[]},{"level":3,"title":"4.\u5220\u9664\u6587\u4EF6\u6216\u76EE\u5F55","slug":"_4-\u5220\u9664\u6587\u4EF6\u6216\u76EE\u5F55","link":"#_4-\u5220\u9664\u6587\u4EF6\u6216\u76EE\u5F55","children":[]},{"level":3,"title":"5.\u83B7\u53D6\u6587\u4EF6\u7684\u5143\u6570\u636E\u4FE1\u606F","slug":"_5-\u83B7\u53D6\u6587\u4EF6\u7684\u5143\u6570\u636E\u4FE1\u606F","link":"#_5-\u83B7\u53D6\u6587\u4EF6\u7684\u5143\u6570\u636E\u4FE1\u606F","children":[]},{"level":3,"title":"6.\u83B7\u53D6\u6587\u4EF6\u7684\u5757\u4FE1\u606F","slug":"_6-\u83B7\u53D6\u6587\u4EF6\u7684\u5757\u4FE1\u606F","link":"#_6-\u83B7\u53D6\u6587\u4EF6\u7684\u5757\u4FE1\u606F","children":[]},{"level":3,"title":"7.\u6587\u4EF6\u7684\u8BFB\u53D6","slug":"_7-\u6587\u4EF6\u7684\u8BFB\u53D6","link":"#_7-\u6587\u4EF6\u7684\u8BFB\u53D6","children":[]},{"level":3,"title":"8.\u6587\u4EF6\u7684\u5199\u5165","slug":"_8-\u6587\u4EF6\u7684\u5199\u5165","link":"#_8-\u6587\u4EF6\u7684\u5199\u5165","children":[]}]}],"relativePath":"linux/hadoop/5hdfs-java.md","lastUpdated":1666573583000}'),p={name:"linux/hadoop/5hdfs-java.md"},o=l(`<h1 id="hdfs-java\u5F00\u53D1" tabindex="-1">HDFS Java\u5F00\u53D1 <a class="header-anchor" href="#hdfs-java\u5F00\u53D1" aria-hidden="true">#</a></h1><p>\u4E0A\u9762\u6211\u4EEC\u4F7F\u7528 HDFS \u547D\u4EE4\u6765\u64CD\u4F5C HDFS \u91CC\u9762\u7684\u6587\u4EF6\u4E0E\u76EE\u5F55\u3002\u6211\u4EEC\u5176\u5B9E\u4E5F\u53EF\u4EE5\u901A\u8FC7 Java \u4EE3\u7801\u6765\u64CD\u4F5C HDFS \u91CC\u9762\u7684\u6587\u4EF6\u4E0E\u76EE\u5F55\uFF0C\u5199\u4EE3\u7801\u4E4B\u524D\u6211\u4EEC\u5148\u642D\u5EFA\u73AF\u5883\u3002\u6211\u4EEC\u8FD9\u91CC\u4F7F\u7528 maven \u6765\u7BA1\u7406 Hadoop \u4F9D\u8D56\u3002</p><h2 id="\u521D\u59CB\u5316\u73AF\u5883" tabindex="-1">\u521D\u59CB\u5316\u73AF\u5883 <a class="header-anchor" href="#\u521D\u59CB\u5316\u73AF\u5883" aria-hidden="true">#</a></h2><ul><li><h3 id="\u628A-hadoop-3-1-4-tar-gz-\u89E3\u538B\u5230\u672C\u5730\u4E00\u4E2A\u975E\u82F1\u6587\u76EE\u5F55\u4E0B" tabindex="-1">\u628A hadoop-3.1.4.tar.gz \u89E3\u538B\u5230\u672C\u5730\u4E00\u4E2A\u975E\u82F1\u6587\u76EE\u5F55\u4E0B <a class="header-anchor" href="#\u628A-hadoop-3-1-4-tar-gz-\u89E3\u538B\u5230\u672C\u5730\u4E00\u4E2A\u975E\u82F1\u6587\u76EE\u5F55\u4E0B" aria-hidden="true">#</a></h3></li></ul><div class="tip custom-block"><p class="custom-block-title">\u4E0B\u8F7D\u5730\u5740</p><p>123\u7F51\u76D8\uFF1A<a href="https://www.123pan.com/s/zCYKVv-sJXR" target="_blank" rel="noreferrer">hadoop-3.1.4</a>\uFF08\u7CBE\u7B80\u7248)(\u63A8\u8350\uFF09</p><p>\u963F\u91CC\u4E91\u955C\u50CF\uFF1A<a href="https://mirrors.aliyun.com/apache/hadoop/common/hadoop-3.3.4/hadoop-3.3.4.tar.gz" target="_blank" rel="noreferrer">https://mirrors.aliyun.com/apache/hadoop/common/hadoop-3.3.4/hadoop-3.3.4.tar.gz</a></p></div><ul><li><h3 id="\u5BFC\u5165-winutils-\u5DE5\u5177\u5305\uFF1A" tabindex="-1">\u5BFC\u5165 winutils \u5DE5\u5177\u5305\uFF1A <a class="header-anchor" href="#\u5BFC\u5165-winutils-\u5DE5\u5177\u5305\uFF1A" aria-hidden="true">#</a></h3></li></ul><div class="warning custom-block"><p class="custom-block-title">\u6CE8\u610F</p><p>\u6B64\u6B65\u9AA4 macOS \u4E0D\u9700\u8981\u914D\u7F6E</p></div><div class="tip custom-block"><p class="custom-block-title">\u4E0B\u8F7D\u5730\u5740</p><p>123\u7F51\u76D8\uFF1A<a href="https://www.123pan.com/s/zCYKVv-ZIXR" target="_blank" rel="noreferrer">winutils-hadoop-3.1.2</a></p></div><h4 id="_1-\u5C06-winutils-\u4E2D-bin-\u76EE\u5F55\u4E0B\u7684-hadoop-dll\u3001winutils-exe-\u62F7\u8D1D\u5230-hadoop-3-1-4-\u7684bin\u76EE\u5F55\u4E0B" tabindex="-1"><strong>1.\u5C06 winutils \u4E2D bin \u76EE\u5F55\u4E0B\u7684 hadoop.dll\u3001winutils.exe \u62F7\u8D1D\u5230 hadoop-3.1.4 \u7684bin\u76EE\u5F55\u4E0B</strong> <a class="header-anchor" href="#_1-\u5C06-winutils-\u4E2D-bin-\u76EE\u5F55\u4E0B\u7684-hadoop-dll\u3001winutils-exe-\u62F7\u8D1D\u5230-hadoop-3-1-4-\u7684bin\u76EE\u5F55\u4E0B" aria-hidden="true">#</a></h4><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019181233967.png" alt="image-20221019181233967"></p><h4 id="_2-\u5C06-winutils-\u4E2D-bin-\u76EE\u5F55\u4E0B\u7684-hadoop-dll-\u62F7\u8D1D\u5230-c-windows-system32-\u76EE\u5F55" tabindex="-1"><strong>2.\u5C06 winutils \u4E2D bin \u76EE\u5F55\u4E0B\u7684 hadoop.dll \u62F7\u8D1D\u5230 C:\\Windows\\System32 \u76EE\u5F55</strong> <a class="header-anchor" href="#_2-\u5C06-winutils-\u4E2D-bin-\u76EE\u5F55\u4E0B\u7684-hadoop-dll-\u62F7\u8D1D\u5230-c-windows-system32-\u76EE\u5F55" aria-hidden="true">#</a></h4><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019181310413.png" alt="image-20221019181310413"></p><ul><li><h3 id="\u914D\u7F6E\u73AF\u5883\u53D8\u91CF-hadoop-home\u3001hadoop-user-name" tabindex="-1">\u914D\u7F6E\u73AF\u5883\u53D8\u91CF HADOOP_HOME\u3001HADOOP_USER_NAME <a class="header-anchor" href="#\u914D\u7F6E\u73AF\u5883\u53D8\u91CF-hadoop-home\u3001hadoop-user-name" aria-hidden="true">#</a></h3></li></ul><p>\u7CFB\u7EDF\u73AF\u5883\u53D8\u91CF</p><ol><li>HADOOP_HOME\uFF1A\u914D\u7F6E\u7684\u662F Hadoop \u7684\u76EE\u5F55\u8DEF\u5F84</li></ol><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019181806354.png" alt="image-20221019181806354"></p><ol start="2"><li>HADOOP_USER_NAME\uFF1A\u914D\u7F6E\u7684\u662F\u6211\u4EEC Linux \u96C6\u7FA4\u91CC\u9762\u5B89\u88C5 Hadoop \u96C6\u7FA4\u7684\u7528\u6237\u540D</li></ol><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019181828744.png" alt="image-20221019181828744"></p><ol start="3"><li>PATH \u4E2D\u5C06 Hadoop \u7684 bin\u76EE\u5F55\u6DFB\u52A0\u8FDB\u53BB</li></ol><div class="language-txt line-numbers-mode"><button class="copy"></button><span class="lang">txt</span><pre><code><span class="line"><span style="color:#A6ACCD;">%HADOOP_HOME%\\bin</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="\u914D\u7F6E-idea" tabindex="-1">\u914D\u7F6E IDEA <a class="header-anchor" href="#\u914D\u7F6E-idea" aria-hidden="true">#</a></h2><ul><li><h3 id="idea-\u5B89\u88C5-big-data-tools-\u63D2\u4EF6" tabindex="-1">IDEA \u5B89\u88C5 Big Data Tools \u63D2\u4EF6 <a class="header-anchor" href="#idea-\u5B89\u88C5-big-data-tools-\u63D2\u4EF6" aria-hidden="true">#</a></h3></li></ul><blockquote><p>Preferences --&gt; Plugins --&gt; Marketplace --&gt; \u641C\u7D22 Big Data Tools --&gt; Install</p></blockquote><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019182424607.png" alt="image-20221019182424607"></p><ul><li><h3 id="\u914D\u7F6E-big-data-tools" tabindex="-1">\u914D\u7F6E Big Data Tools <a class="header-anchor" href="#\u914D\u7F6E-big-data-tools" aria-hidden="true">#</a></h3></li></ul><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019184635575.png" alt="image-20221019184635575" style="zoom:50%;"><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019184626561.png" alt="image-20221019184626561"></p><ul><li><h3 id="\u67E5\u770B-hdfs-\u662F\u5426\u8FDE\u63A5\u6210\u529F" tabindex="-1">\u67E5\u770B HDFS \u662F\u5426\u8FDE\u63A5\u6210\u529F <a class="header-anchor" href="#\u67E5\u770B-hdfs-\u662F\u5426\u8FDE\u63A5\u6210\u529F" aria-hidden="true">#</a></h3></li></ul><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221019184859957.png" alt="image-20221019184859957" style="zoom:60%;"><div class="tip custom-block"><p class="custom-block-title">\u914D\u7F6E\u5B8C\u6210</p><p>\u5230\u8FD9\u4E00\u6B65\u5982\u679C\u8FDE\u63A5\u6210\u529F\u5E76\u80FD\u770B\u5230 HDFS \u6587\u4EF6\u76EE\u5F55\u5219\u8BF4\u660E\u914D\u7F6E\u6210\u529F \u{1F389} \u{1F4AF} \u{1F3C6}</p></div><h2 id="\u521B\u5EFA-maven-\u9879\u76EE" tabindex="-1">\u521B\u5EFA Maven \u9879\u76EE <a class="header-anchor" href="#\u521B\u5EFA-maven-\u9879\u76EE" aria-hidden="true">#</a></h2><ul><li><h3 id="_1-\u65B0\u5EFA-maven-\u9879\u76EE" tabindex="-1">1. \u65B0\u5EFA Maven \u9879\u76EE <a class="header-anchor" href="#_1-\u65B0\u5EFA-maven-\u9879\u76EE" aria-hidden="true">#</a></h3></li></ul><p><img src="https://notewk-1304925042.cos.ap-guangzhou.myqcloud.com/notewk/image-20221020111844412.png" alt="image-20221020111844412"></p><ul><li><h3 id="_2-\u5BFC\u5165hadoop\u7684\u4F9D\u8D56" tabindex="-1">2. \u5BFC\u5165hadoop\u7684\u4F9D\u8D56 <a class="header-anchor" href="#_2-\u5BFC\u5165hadoop\u7684\u4F9D\u8D56" aria-hidden="true">#</a></h3></li></ul><p><strong>\u914D\u7F6E pom.xml \u6587\u4EF6</strong></p><div class="language-xml line-numbers-mode"><button class="copy"></button><span class="lang">xml</span><pre><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">project</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://maven.apache.org/POM/4.0.0</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">         </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">xsi</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">         </span><span style="color:#C792EA;">xsi</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">schemaLocation</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://maven.apache.org/POM/4.0.0</span></span>
<span class="line"><span style="color:#C3E88D;">         http://maven.apache.org/xsd/maven-4.0.0.xsd]</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  &lt;groupId&gt;com.kevin.hdfs&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;artifactId&gt;HDFS&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;packaging&gt;pom&lt;/packaging&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  &lt;!-- \u5C5E\u6027 --&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;properties&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;!-- hadoop \u7248\u672C --&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;hadoop.version&gt;3.1.4&lt;/hadoop.version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;/properties&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  &lt;!-- \u4F9D\u8D56 --&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;dependencies&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;hadoop-client&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;\${hadoop.version}&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;hadoop-common&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;\${hadoop.version}&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;hadoop-hdfs&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;\${hadoop.version}&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;hadoop-mapreduce-client-core&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;\${hadoop.version}&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;junit&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;junit&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;4.11&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;scope&gt;test&lt;/scope&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;org.testng&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;testng&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;RELEASE&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;groupId&gt;log4j&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;artifactId&gt;log4j&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">      &lt;version&gt;1.2.17&lt;/version&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">    &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">  &lt;/dependencies&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">&lt;/project&gt;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><h2 id="hdfs-\u64CD\u4F5C" tabindex="-1">HDFS \u64CD\u4F5C <a class="header-anchor" href="#hdfs-\u64CD\u4F5C" aria-hidden="true">#</a></h2><ul><li><h3 id="_1-\u4F7F\u7528-hdfs-\u521B\u5EFA\u76EE\u5F55" tabindex="-1">1. \u4F7F\u7528 HDFS \u521B\u5EFA\u76EE\u5F55 <a class="header-anchor" href="#_1-\u4F7F\u7528-hdfs-\u521B\u5EFA\u76EE\u5F55" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button class="copy"></button><span class="lang">java</span><pre><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;">* \u521B\u5EFA\u76EE\u5F55</span></span>
<span class="line"><span style="color:#676E95;">* </span><span style="color:#F78C6C;">@throws</span><span style="color:#676E95;"> </span><span style="color:#FFCB6B;">IOException</span></span>
<span class="line"><span style="color:#676E95;">*/</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">mkDir</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u521B\u5EFA\u914D\u7F6E\u7C7B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u914D\u7F6E\u8981\u8FDE\u63A5\u7684 hdfs \u96C6\u7FA4</span></span>
<span class="line"><span style="color:#A6ACCD;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u521B\u5EFA\u76EE\u5F55</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> filePath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/mkdir</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">Path</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">filePath</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u64CD\u4F5C\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u5F97\u5230\u6587\u4EF6\u7CFB\u7EDF\u7684\u5B9E\u4F8B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u521B\u5EFA\u6587\u4EF6\u5939</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">if</span><span style="color:#89DDFF;">(!</span><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">exists</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">)){</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u6587\u4EF6\u5939\u4E0D\u5B58\u5728</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">boolean</span><span style="color:#A6ACCD;"> bool </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mkdirs</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">bool</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span><span style="color:#89DDFF;">else</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">filePath </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u5DF2\u5B58\u5728</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><ul><li><h3 id="_2-\u4E0A\u4F20\u6587\u4EF6" tabindex="-1">2. \u4E0A\u4F20\u6587\u4EF6 <a class="header-anchor" href="#_2-\u4E0A\u4F20\u6587\u4EF6" aria-hidden="true">#</a></h3></li></ul><p><strong>\u5C06\u793A\u4F8B\u6587\u4EF6 line200000.txt \u653E\u5728 maven \u9879\u76EE\u4E3B\u76EE\u5F55\u4E0B</strong></p><div class="tip custom-block"><p class="custom-block-title">\u4E0B\u8F7D\u5730\u5740</p><p>123\u7F51\u76D8\uFF1A<a href="https://www.123pan.com/s/zCYKVv-cIXR" target="_blank" rel="noreferrer">line200000.txt</a></p></div><div class="language-java line-numbers-mode"><button class="copy"></button><span class="lang">java</span><pre><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u4E0A\u4F20\u6587\u4EF6</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#F78C6C;">@throws</span><span style="color:#676E95;"> </span><span style="color:#FFCB6B;">IOException</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">uploadFile</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u521B\u5EFA\u914D\u7F6E\u7C7B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u914D\u7F6E\u8981\u8FDE\u63A5\u7684 hdfs \u96C6\u7FA4</span></span>
<span class="line"><span style="color:#A6ACCD;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u64CD\u4F5C\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u5F97\u5230\u6587\u4EF6\u7CFB\u7EDF\u7684\u5B9E\u4F8B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#A6ACCD;"> fileSystem </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// line200000.txt \u4E0A\u4F20\u5230 /input/line200000.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">copyFromLocalFile</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">                               </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">//\u91CA\u653E\u8D44\u6E90</span></span>
<span class="line"><span style="color:#A6ACCD;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li><h3 id="_3-\u4E0B\u8F7D\u6587\u4EF6" tabindex="-1">3. \u4E0B\u8F7D\u6587\u4EF6 <a class="header-anchor" href="#_3-\u4E0B\u8F7D\u6587\u4EF6" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button class="copy"></button><span class="lang">java</span><pre><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u4E0B\u8F7D\u6587\u4EF6</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#F78C6C;">@throws</span><span style="color:#676E95;"> </span><span style="color:#FFCB6B;">IOException</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">downloadFile</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u521B\u5EFA\u914D\u7F6E\u7C7B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u914D\u7F6E\u8981\u8FDE\u63A5\u7684 hdfs \u96C6\u7FA4</span></span>
<span class="line"><span style="color:#A6ACCD;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u64CD\u4F5C\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u5F97\u5230\u6587\u4EF6\u7CFB\u7EDF\u7684\u5B9E\u4F8B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#A6ACCD;"> fileSystem </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u5C06 /input/line200000.txt \u4E0B\u8F7D\u5230 ./src/download.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">copyToLocalFile</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">                             </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/download.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u91CA\u653E\u8D44\u6E90</span></span>
<span class="line"><span style="color:#A6ACCD;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li><h3 id="_4-\u5220\u9664\u6587\u4EF6\u6216\u76EE\u5F55" tabindex="-1">4.\u5220\u9664\u6587\u4EF6\u6216\u76EE\u5F55 <a class="header-anchor" href="#_4-\u5220\u9664\u6587\u4EF6\u6216\u76EE\u5F55" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button class="copy"></button><span class="lang">java</span><pre><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u5220\u9664\u6587\u4EF6</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#F78C6C;">@throws</span><span style="color:#676E95;"> </span><span style="color:#FFCB6B;">IOException</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">deleteFile</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u521B\u5EFA\u914D\u7F6E\u7C7B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u914D\u7F6E\u8981\u8FDE\u63A5\u7684 hdfs \u96C6\u7FA4</span></span>
<span class="line"><span style="color:#A6ACCD;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u64CD\u4F5C\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u5F97\u5230\u6587\u4EF6\u7CFB\u7EDF\u7684\u5B9E\u4F8B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#A6ACCD;"> fileSystem </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u5220\u9664 /input/mkdir \u76EE\u5F55</span></span>
<span class="line"><span style="color:#A6ACCD;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">delete</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/mkdir</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),true);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u5220\u9664 /input/line200000.txt \u6587\u4EF6</span></span>
<span class="line"><span style="color:#A6ACCD;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">delete</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),true);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u5220\u9664 /input/write.txt \u6587\u4EF6</span></span>
<span class="line"><span style="color:#A6ACCD;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">delete</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/write.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),true);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u91CA\u653E\u8D44\u6E90</span></span>
<span class="line"><span style="color:#A6ACCD;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><ul><li><h3 id="_5-\u83B7\u53D6\u6587\u4EF6\u7684\u5143\u6570\u636E\u4FE1\u606F" tabindex="-1">5.\u83B7\u53D6\u6587\u4EF6\u7684\u5143\u6570\u636E\u4FE1\u606F <a class="header-anchor" href="#_5-\u83B7\u53D6\u6587\u4EF6\u7684\u5143\u6570\u636E\u4FE1\u606F" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button class="copy"></button><span class="lang">java</span><pre><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u83B7\u53D6\u6587\u4EF6\u7684\u5143\u6570\u636E\u4FE1\u606F</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#F78C6C;">@throws</span><span style="color:#676E95;"> </span><span style="color:#FFCB6B;">IOException</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getFileMeta</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u521B\u5EFA\u914D\u7F6E\u7C7B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u914D\u7F6E\u8981\u8FDE\u63A5\u7684 hdfs \u96C6\u7FA4</span></span>
<span class="line"><span style="color:#A6ACCD;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u64CD\u4F5C\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u5F97\u5230\u6587\u4EF6\u7CFB\u7EDF\u7684\u5B9E\u4F8B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#A6ACCD;"> fileSystem </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u8981\u8BFB\u53D6\u7684\u6587\u4EF6</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">Path</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// FileStatus\u7C7B\u5C01\u88C5\u4E86\u6587\u4EF6\u7CFB\u7EDF\u4E2D\u6587\u4EF6\u548C\u76EE\u5F55\u7684\u5143\u6570\u636E\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">FileStatus</span><span style="color:#A6ACCD;"> status </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getFileStatus</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u5206\u522B\u83B7\u53D6\u5143\u6570\u636E\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;">  System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u5757\u5927\u5C0F\uFF1A</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBlockSize</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">  System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u6587\u4EF6\u5927\u5C0F\uFF1A</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLen</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">  System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u526F\u672C\u6570\uFF1A</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getReplication</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">  System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u6240\u6709\u8005\uFF1A</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getOwner</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#A6ACCD;">  System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\u4FEE\u6539\u65F6\u95F4\uFF1A</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getModificationTime</span><span style="color:#89DDFF;">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u91CA\u653E\u8D44\u6E90</span></span>
<span class="line"><span style="color:#A6ACCD;">  fileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><ul><li><h3 id="_6-\u83B7\u53D6\u6587\u4EF6\u7684\u5757\u4FE1\u606F" tabindex="-1">6.\u83B7\u53D6\u6587\u4EF6\u7684\u5757\u4FE1\u606F <a class="header-anchor" href="#_6-\u83B7\u53D6\u6587\u4EF6\u7684\u5757\u4FE1\u606F" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button class="copy"></button><span class="lang">java</span><pre><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u83B7\u53D6\u6587\u4EF6\u7684\u5757\u4FE1\u606F</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#F78C6C;">@throws</span><span style="color:#676E95;"> </span><span style="color:#FFCB6B;">IOException</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getFileBlockLocations</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u521B\u5EFA\u914D\u7F6E\u7C7B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u914D\u7F6E\u8981\u8FDE\u63A5\u7684 hdfs \u96C6\u7FA4</span></span>
<span class="line"><span style="color:#A6ACCD;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u64CD\u4F5C\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u5F97\u5230\u6587\u4EF6\u7CFB\u7EDF\u7684\u5B9E\u4F8B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u8981\u8BFB\u53D6\u7684\u6587\u4EF6</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">Path</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;">/* FileStatus\u7C7B\u5C01\u88C5\u4E86\u6587\u4EF6\u7CFB\u7EDF\u4E2D\u6587\u4EF6\u548C\u76EE\u5F55\u7684\u5143\u6570\u636E,</span></span>
<span class="line"><span style="color:#676E95;">           \u5305\u62EC\u6587\u4EF6\u957F\u5EA6\u3001\u5757\u5927\u5C0F\u3001\u5907\u4EFD\u3001\u4FEE\u6539\u65F6\u95F4\u3001\u6240\u6709\u8005\u4EE5\u53CA\u6743\u9650\u4FE1\u606F */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">FileStatus</span><span style="color:#A6ACCD;"> status </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getFileStatus</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u83B7\u5F97\u6587\u4EF6\u7684\u5757\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">BlockLocation</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> blockLocations </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getFileBlockLocations</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">status</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> status</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLen</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u8FED\u4EE3\u5757\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">for</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">BlockLocation</span><span style="color:#A6ACCD;"> bl</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">blockLocations</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u504F\u79FB\u91CF</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">long</span><span style="color:#A6ACCD;"> offset </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> bl</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getOffset</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u957F\u5EA6</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">long</span><span style="color:#A6ACCD;"> len </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> bl</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getLength</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u6570\u636E\u8282\u70B9\u540D</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> hosts </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> bl</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getHosts</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">offset </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> len </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> Arrays</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">asList</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">hosts</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u91CA\u653E\u8D44\u6E90</span></span>
<span class="line"><span style="color:#A6ACCD;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><ul><li><h3 id="_7-\u6587\u4EF6\u7684\u8BFB\u53D6" tabindex="-1">7.\u6587\u4EF6\u7684\u8BFB\u53D6 <a class="header-anchor" href="#_7-\u6587\u4EF6\u7684\u8BFB\u53D6" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button class="copy"></button><span class="lang">java</span><pre><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u6587\u4EF6\u7684\u8BFB\u53D6</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#F78C6C;">@throws</span><span style="color:#676E95;"> </span><span style="color:#FFCB6B;">IOException</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">readFile</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u521B\u5EFA\u914D\u7F6E\u7C7B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u914D\u7F6E\u8981\u8FDE\u63A5\u7684 hdfs \u96C6\u7FA4</span></span>
<span class="line"><span style="color:#A6ACCD;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u64CD\u4F5C\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u5F97\u5230\u6587\u4EF6\u7CFB\u7EDF\u7684\u5B9E\u4F8B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u8981\u8BFB\u53D6\u7684\u6587\u4EF6</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">Path</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/line200000.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u83B7\u53D6\u8F93\u5165\u6D41</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">FSDataInputStream</span><span style="color:#A6ACCD;"> fdis </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">open</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u8BBE\u7F6E\u504F\u79FB\u91CF\uFF1A0</span></span>
<span class="line"><span style="color:#A6ACCD;">  fdis</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">seek</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">byte</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> buffer </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">byte</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">512</span><span style="color:#89DDFF;">];</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> len </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">while</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">((</span><span style="color:#A6ACCD;">len </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fdis</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">read</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">buffer</span><span style="color:#89DDFF;">))</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">String</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">buffer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> len</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u91CA\u653E\u8D44\u6E90</span></span>
<span class="line"><span style="color:#A6ACCD;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><ul><li><h3 id="_8-\u6587\u4EF6\u7684\u5199\u5165" tabindex="-1">8.\u6587\u4EF6\u7684\u5199\u5165 <a class="header-anchor" href="#_8-\u6587\u4EF6\u7684\u5199\u5165" aria-hidden="true">#</a></h3></li></ul><div class="language-java line-numbers-mode"><button class="copy"></button><span class="lang">java</span><pre><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u6587\u4EF6\u7684\u5199\u5165</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#F78C6C;">@throws</span><span style="color:#676E95;"> </span><span style="color:#FFCB6B;">IOException</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Test</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">writeFile</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> throws IOException </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u521B\u5EFA\u914D\u7F6E\u7C7B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">Configuration</span><span style="color:#A6ACCD;"> conf </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Configuration</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u914D\u7F6E\u8981\u8FDE\u63A5\u7684 hdfs \u96C6\u7FA4</span></span>
<span class="line"><span style="color:#A6ACCD;">  conf</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.defaultFS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hdfs://node01:8020</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u64CD\u4F5C\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u5F97\u5230\u6587\u4EF6\u7CFB\u7EDF\u7684\u5B9E\u4F8B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">FileSystem</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> FileSystem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">conf</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u8981\u5199\u5165\u7684\u6587\u4EF6</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">File</span><span style="color:#A6ACCD;"> source </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">File</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">word.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u5199\u5165\u5230HDFS\u7684\u8DEF\u5F84</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">Path</span><span style="color:#A6ACCD;"> desc </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Path</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/input/write.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u5206\u522B\u6784\u5EFA\u8F93\u5165\u8F93\u51FA\u6D41</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">InputStream</span><span style="color:#A6ACCD;"> is </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">FileInputStream</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">source</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">FSDataOutputStream</span><span style="color:#A6ACCD;"> fdos </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">create</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">desc</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// IO\u64CD\u4F5C:\u8FB9\u8BFB\u8FB9\u5199</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">byte</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> buffer </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">byte</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">200</span><span style="color:#89DDFF;">];</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> len</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">while</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">((</span><span style="color:#A6ACCD;">len </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> is</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">read</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">buffer</span><span style="color:#89DDFF;">))</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">!=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    fdos</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">buffer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> len</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u6587\u4EF6\u7CFB\u7EDF\u7528\u5B8C\u4EE5\u540E\u9700\u8981\u5173\u95ED</span></span>
<span class="line"><span style="color:#A6ACCD;">  fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">  is</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div>`,55),e=[o];function r(t,c,D,F,y,i){return a(),n("div",null,e)}const b=s(p,[["render",r]]);export{C as __pageData,b as default};
